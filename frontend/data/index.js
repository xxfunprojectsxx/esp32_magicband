(()=>{const e="192.168.4.1"===location.hostname?"":"http://192.168.4.1";let t=!1;function n(e){document.querySelectorAll("button").forEach(t=>{t.disabled=e,e?(t.style.opacity="0.5",t.style.cursor="not-allowed"):(t.style.opacity="1",t.style.cursor="pointer")}),t=e}function o(e,t=!0){const n=document.createElement("div");n.className="toast",n.textContent=e,n.style.background=t?"linear-gradient(135deg,#22c55e,#66d39a)":"linear-gradient(135deg,#ff6b6b,#ff8b6b)",n.style.color="#021014",document.body.appendChild(n),setTimeout(()=>n.remove(),1400)}function c(e){const t=parseInt(e.substr(1,2),16),n=parseInt(e.substr(3,2),16),o=parseInt(e.substr(5,2),16);return t>200&&n<100&&o<100?21:t<100&&n<100&&o>200?2:t<100&&n>200&&o<100?25:t>200&&n>100&&o<100?19:t>150&&n<100&&o>150?1:t>200&&n>100&&o>150?8:t<100&&n>200&&o>200?0:t>200&&n>200&&o<100?15:27}async function d(c){if(t)o("Request in progress...",!1);else{n(!0);try{await fetch(`${e}/command`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=ping"}).catch(()=>{}),await new Promise(e=>setTimeout(e,420));const t=await fetch(`${e}/command`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c});if(!t.ok)throw new Error("request failed");const n=await t.text();return o("Sent",!0),n}catch(e){throw o(`Error ${e}`,!1),e}finally{n(!1)}}}window.sendPreset=function(e){const t=document.getElementById("vibToggle").checked?document.getElementById("vibPattern").value:0;d(`action=preset&color=${encodeURIComponent(e)}&vib=${t}`).catch(()=>{})},window.sendDual=function(){d(`action=dual&c1=${c(document.getElementById("dualInner").value)}&c2=${c(document.getElementById("dualOuter").value)}&vib=${document.getElementById("vibToggle").checked?document.getElementById("vibPattern").value:0}`).catch(()=>{})},window.sendCross=function(){d(`action=crossfade&c1=${c(document.getElementById("crossA").value)}&c2=${c(document.getElementById("crossB").value)}&vib=${document.getElementById("vibToggle").checked?document.getElementById("vibPattern").value:0}`).catch(()=>{})},window.sendRainbow=function(){d(`action=rainbow&c1=${c(document.getElementById("r1").value)}&c2=${c(document.getElementById("r2").value)}&c3=${c(document.getElementById("r3").value)}&c4=${c(document.getElementById("r4").value)}&c5=${c(document.getElementById("r5").value)}&vib=${document.getElementById("vibToggle").checked?document.getElementById("vibPattern").value:0}`).catch(()=>{})},window.sendCircle=function(){d(`action=circle&vib=${document.getElementById("vibToggle").checked?document.getElementById("vibPattern").value:0}`).catch(()=>{})},window.sendPing=function(){t?o("Request in progress...",!1):(n(!0),fetch(`${e}/command`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=ping"}).then(e=>{e.ok?o("Wake sent",!0):o("Wake failed",!1)}).catch(()=>o("Wake failed",!1)).finally(()=>n(!1)))},window.sendManual=function(){const e=document.getElementById("manual").value.trim();e?d(e).catch(()=>{}):o("Enter command",!1)}})();